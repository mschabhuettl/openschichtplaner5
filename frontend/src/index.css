@tailwind base;
@tailwind components;
@tailwind utilities;

/* ── CSS Custom Properties ──────────────────────────────────── */
:root {
  /* Light theme */
  --color-bg:        #f3f4f6; /* gray-100 */
  --color-surface:   #ffffff; /* white */
  --color-surface2:  #f9fafb; /* gray-50 */
  --color-surface3:  #f3f4f6; /* gray-100 */
  --color-border:    #e5e7eb; /* gray-200 */
  --color-border2:   #d1d5db; /* gray-300 */
  --color-text:      #111827; /* gray-900 */
  --color-text2:     #1f2937; /* gray-800 */
  --color-text3:     #374151; /* gray-700 */
  --color-text-muted: #6b7280; /* gray-500 */
  --color-text-subtle: #9ca3af; /* gray-400 */
  --color-shadow:    0 1px 3px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06);
  --color-shadow-md: 0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.06);
  --color-input-bg:  #ffffff;
  --color-input-border: #d1d5db;
  --color-header-bg: #1e293b; /* slate-800 */
  --transition-theme: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}

html.dark {
  /* Dark theme */
  --color-bg:        #0f172a; /* slate-900 */
  --color-surface:   #1e293b; /* slate-800 */
  --color-surface2:  #1e293b; /* slate-800 */
  --color-surface3:  #0f172a; /* slate-900 */
  --color-border:    #334155; /* slate-700 */
  --color-border2:   #475569; /* slate-600 */
  --color-text:      #f1f5f9; /* slate-100 */
  --color-text2:     #e2e8f0; /* slate-200 */
  --color-text3:     #cbd5e1; /* slate-300 */
  --color-text-muted: #94a3b8; /* slate-400 */
  --color-text-subtle: #64748b; /* slate-500 */
  --color-shadow:    0 1px 3px rgba(0,0,0,0.4), 0 1px 2px rgba(0,0,0,0.3);
  --color-shadow-md: 0 4px 6px rgba(0,0,0,0.3), 0 2px 4px rgba(0,0,0,0.25);
  --color-input-bg:  #1e293b;
  --color-input-border: #475569;
  --color-header-bg: #0f172a;
  /* Tell browser to render native controls (selects, date pickers, etc.) in dark mode */
  color-scheme: dark;
}

body {
  @apply bg-gray-100 text-gray-900;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  transition: var(--transition-theme);
}

/* ── Dark Mode: Background Overrides ───────────────────────── */

html.dark body {
  background-color: var(--color-bg) !important;
  color: var(--color-text) !important;
}

/* Main layout containers */
html.dark .bg-gray-100 { background-color: var(--color-bg) !important; }
html.dark .bg-gray-50  { background-color: var(--color-surface2) !important; }
html.dark .bg-gray-200 { background-color: #334155 !important; }
html.dark .bg-gray-300 { background-color: #475569 !important; }
html.dark .bg-white    { background-color: var(--color-surface) !important; }

/* Slate variants (some pages use slate- instead of gray-) */
html.dark .bg-slate-50  { background-color: var(--color-surface2) !important; }
html.dark .bg-slate-100 { background-color: var(--color-bg) !important; }
html.dark .bg-slate-200 { background-color: #334155 !important; }

/* Tinted accent backgrounds — muted in dark mode */
html.dark .bg-blue-50   { background-color: #0d1f3c !important; }
html.dark .bg-blue-100  { background-color: #1e3a5f !important; }
html.dark .bg-green-50  { background-color: #0d2218 !important; }
html.dark .bg-green-100 { background-color: #14391f !important; }
html.dark .bg-red-50    { background-color: #2d1212 !important; }
html.dark .bg-red-100   { background-color: #3d1a1a !important; }
html.dark .bg-yellow-50 { background-color: #2a1f00 !important; }
html.dark .bg-yellow-100 { background-color: #3a2c00 !important; }
html.dark .bg-orange-50 { background-color: #2a1500 !important; }
html.dark .bg-orange-100 { background-color: #3d1e00 !important; }
html.dark .bg-purple-50 { background-color: #1a0d2e !important; }
html.dark .bg-purple-100 { background-color: #2a1845 !important; }
html.dark .bg-teal-50   { background-color: #0a1f20 !important; }
html.dark .bg-teal-100  { background-color: #0d2e30 !important; }
html.dark .bg-indigo-50 { background-color: #13153a !important; }
html.dark .bg-indigo-100 { background-color: #1c2050 !important; }
html.dark .bg-pink-50   { background-color: #2d0d1f !important; }
html.dark .bg-emerald-50 { background-color: #0d2218 !important; }
html.dark .bg-amber-50  { background-color: #2a1f00 !important; }
html.dark .bg-cyan-50   { background-color: #0a1f28 !important; }

/* ── Dark Mode: Text Overrides ───────────────────────────────── */
html.dark .text-gray-900 { color: var(--color-text) !important; }
html.dark .text-gray-800 { color: var(--color-text2) !important; }
html.dark .text-gray-700 { color: var(--color-text3) !important; }
html.dark .text-gray-600 { color: var(--color-text-muted) !important; }
html.dark .text-gray-500 { color: #64748b !important; }
html.dark .text-gray-400 { color: #475569 !important; }
html.dark .text-gray-300 { color: #334155 !important; }

html.dark .text-slate-900 { color: var(--color-text) !important; }
html.dark .text-slate-800 { color: var(--color-text2) !important; }
html.dark .text-slate-700 { color: var(--color-text3) !important; }
html.dark .text-slate-600 { color: var(--color-text-muted) !important; }

/* ── Dark Mode: Border Overrides ─────────────────────────────── */
html.dark .border-gray-100 { border-color: #1e293b !important; }
html.dark .border-gray-200 { border-color: var(--color-border) !important; }
html.dark .border-gray-300 { border-color: var(--color-border2) !important; }
html.dark .border-gray-400 { border-color: #64748b !important; }
html.dark .border-slate-200 { border-color: var(--color-border) !important; }
html.dark .border-slate-300 { border-color: var(--color-border2) !important; }

/* ── Dark Mode: Divide (hr-like borders inside flex/grid) ────── */
html.dark .divide-gray-100 > * + * { border-color: #1e293b !important; }
html.dark .divide-gray-200 > * + * { border-color: var(--color-border) !important; }
html.dark .divide-gray-300 > * + * { border-color: var(--color-border2) !important; }

/* ── Dark Mode: Hover backgrounds ───────────────────────────── */
html.dark .hover\:bg-gray-50:hover  { background-color: #1e293b !important; }
html.dark .hover\:bg-gray-100:hover { background-color: #334155 !important; }
html.dark .hover\:bg-gray-200:hover { background-color: #475569 !important; }

/* ── Dark Mode: Form inputs ──────────────────────────────────── */
html.dark input:not([type="checkbox"]):not([type="radio"]):not([type="range"]):not([type="color"]),
html.dark select,
html.dark textarea {
  background-color: var(--color-input-bg) !important;
  border-color: var(--color-input-border) !important;
  color: var(--color-text) !important;
  color-scheme: dark;
}

html.dark input:focus:not([type="checkbox"]):not([type="radio"]):not([type="range"]),
html.dark select:focus,
html.dark textarea:focus {
  border-color: #3b82f6 !important;
  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2) !important;
}

html.dark input::placeholder,
html.dark textarea::placeholder {
  color: #64748b !important;
}

html.dark input[disabled],
html.dark select[disabled],
html.dark textarea[disabled] {
  background-color: #0f172a !important;
  color: #64748b !important;
  cursor: not-allowed;
}

/* ── Dark Mode: Tables ───────────────────────────────────────── */
html.dark table {
  color: var(--color-text) !important;
}

html.dark th {
  background-color: #1e293b !important;
  color: var(--color-text2) !important;
  border-color: var(--color-border) !important;
}

html.dark td {
  border-color: var(--color-border) !important;
}

html.dark tr:hover td,
html.dark tbody tr:hover {
  background-color: rgba(30, 41, 59, 0.7) !important;
}

/* Alternating row colors */
html.dark tbody tr:nth-child(even) {
  background-color: rgba(30, 41, 59, 0.4) !important;
}

html.dark .bg-gray-100 th { background-color: #1a2535 !important; }

/* ── Dark Mode: Skeleton loading ─────────────────────────────── */
html.dark .bg-gray-200.animate-pulse { background-color: #1e293b !important; }
html.dark .animate-pulse .bg-gray-200 { background-color: #1e293b !important; }

/* ── Dark Mode: Shadows ──────────────────────────────────────── */
html.dark .shadow    { box-shadow: var(--color-shadow) !important; }
html.dark .shadow-sm { box-shadow: 0 1px 2px rgba(0,0,0,0.4) !important; }
html.dark .shadow-md { box-shadow: var(--color-shadow-md) !important; }
html.dark .shadow-lg { box-shadow: 0 10px 15px rgba(0,0,0,0.4), 0 4px 6px rgba(0,0,0,0.3) !important; }
html.dark .shadow-xl { box-shadow: 0 20px 25px rgba(0,0,0,0.5), 0 8px 10px rgba(0,0,0,0.4) !important; }

/* ── Dark Mode: Modals / Overlays ────────────────────────────── */
html.dark .bg-black\/50 { background-color: rgba(0, 0, 0, 0.7) !important; }

/* ── Dark Mode: Toast notifications ─────────────────────────── */
html.dark .bg-slate-800 { background-color: #0f172a !important; }

/* ── Dark Mode: Sidebar (stays dark, ensure consistency) ──────── */
/* The sidebar is already bg-slate-800 — override to slate-950 in dark mode */
html.dark aside.fixed { background-color: #0a0f1e !important; }
html.dark aside.fixed .border-slate-700 { border-color: #1e293b !important; }

/* ── Dark Mode: Mobile header ────────────────────────────────── */
html.dark header.bg-slate-800 { background-color: #0a0f1e !important; }

/* ── Dark Mode: Scrollbar ────────────────────────────────────── */
html.dark {
  scrollbar-color: #334155 #0f172a;
}
html.dark ::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}
html.dark ::-webkit-scrollbar-track {
  background: #0f172a;
}
html.dark ::-webkit-scrollbar-thumb {
  background: #334155;
  border-radius: 4px;
}
html.dark ::-webkit-scrollbar-thumb:hover {
  background: #475569;
}

/* ── Dark Mode: Charts/Recharts overrides ────────────────────── */
html.dark .recharts-text { fill: #94a3b8 !important; }
html.dark .recharts-cartesian-axis-line { stroke: #334155 !important; }
html.dark .recharts-cartesian-axis-tick-line { stroke: #334155 !important; }
html.dark .recharts-cartesian-grid-horizontal line,
html.dark .recharts-cartesian-grid-vertical line { stroke: #1e293b !important; }
html.dark .recharts-tooltip-wrapper .recharts-default-tooltip {
  background-color: #1e293b !important;
  border-color: #334155 !important;
  color: #f1f5f9 !important;
}
html.dark .recharts-legend-item-text { color: #94a3b8 !important; }

/* ── Dark Mode: Ring/Focus ───────────────────────────────────── */
html.dark .ring-gray-200 { --tw-ring-color: #334155 !important; }
html.dark .ring-slate-300 { --tw-ring-color: #475569 !important; }

/* ── Dark Mode: Badge / pill backgrounds ─────────────────────── */
html.dark .bg-blue-100.text-blue-800   { background-color: #1e3a5f !important; color: #93c5fd !important; }
html.dark .bg-green-100.text-green-800 { background-color: #14391f !important; color: #86efac !important; }
html.dark .bg-red-100.text-red-800     { background-color: #3d1a1a !important; color: #fca5a5 !important; }
html.dark .bg-yellow-100.text-yellow-800 { background-color: #3a2c00 !important; color: #fde047 !important; }
html.dark .bg-orange-100.text-orange-800 { background-color: #3d1e00 !important; color: #fdba74 !important; }
html.dark .bg-purple-100.text-purple-800 { background-color: #2a1845 !important; color: #c4b5fd !important; }
html.dark .bg-gray-100.text-gray-600   { background-color: #1e293b !important; color: #94a3b8 !important; }

/* ── Dark Mode: Text accent colors — slightly brighten in dark ── */
html.dark .text-blue-600  { color: #60a5fa !important; }
html.dark .text-blue-700  { color: #93c5fd !important; }
html.dark .text-blue-800  { color: #bfdbfe !important; }
html.dark .text-green-600 { color: #4ade80 !important; }
html.dark .text-green-700 { color: #86efac !important; }
html.dark .text-green-800 { color: #bbf7d0 !important; }
html.dark .text-red-600   { color: #f87171 !important; }
html.dark .text-red-700   { color: #fca5a5 !important; }
html.dark .text-red-800   { color: #fecaca !important; }
html.dark .text-orange-600 { color: #fb923c !important; }
html.dark .text-orange-700 { color: #fdba74 !important; }
html.dark .text-orange-800 { color: #fed7aa !important; }
html.dark .text-yellow-600 { color: #facc15 !important; }
html.dark .text-yellow-700 { color: #fde047 !important; }
html.dark .text-amber-600  { color: #fbbf24 !important; }
html.dark .text-amber-700  { color: #fcd34d !important; }
html.dark .text-purple-600 { color: #a78bfa !important; }
html.dark .text-purple-700 { color: #c4b5fd !important; }
html.dark .text-teal-600   { color: #2dd4bf !important; }
html.dark .text-teal-700   { color: #5eead4 !important; }
html.dark .text-indigo-600 { color: #818cf8 !important; }
html.dark .text-indigo-700 { color: #a5b4fc !important; }
html.dark .text-emerald-600 { color: #34d399 !important; }
html.dark .text-emerald-700 { color: #6ee7b7 !important; }
html.dark .text-cyan-600   { color: #22d3ee !important; }
html.dark .text-pink-600   { color: #f472b6 !important; }
html.dark .text-rose-600   { color: #fb7185 !important; }

/* ── Dark Mode: Accent backgrounds (buttons) — keep saturated ── */
/* Blue, red, green action buttons stay as is */
/* Only adjust hover states */
html.dark .hover\:bg-blue-700:hover   { background-color: #1d4ed8 !important; }
html.dark .hover\:bg-green-700:hover  { background-color: #15803d !important; }
html.dark .hover\:bg-red-700:hover    { background-color: #b91c1c !important; }

/* ── Dark Mode: Border-b / border-t on table headers ─────────── */
html.dark .border-b.border-gray-200 { border-bottom-color: var(--color-border) !important; }
html.dark .border-t.border-gray-200 { border-top-color: var(--color-border) !important; }

/* ── Theme transition: smooth switching ──────────────────────── */
*,
*::before,
*::after {
  transition-property: background-color, border-color, color;
  transition-duration: 150ms;
  transition-timing-function: ease;
}

/* Don't animate transforms or sizes (causes jank) */
button,
a,
[class*="animate-"],
[class*="transition-"] {
  transition: unset;
}

button { transition: background-color 150ms ease, color 150ms ease, border-color 150ms ease, opacity 150ms ease; }
a { transition: color 150ms ease; }

/* ── Global Print Styles ──────────────────────────────────── */
@media print {
  @page {
    size: landscape;
    margin: 10mm;
  }

  /* Hide navigation, sidebar, header and interactive controls */
  .sidebar,
  .no-print,
  nav,
  aside,
  header,
  [class*="translate-x-"],
  .fixed.inset-y-0 {
    display: none !important;
  }

  /* Make main content fill the full width */
  body {
    font-size: 10px;
    background: white !important;
    margin: 0 !important;
    padding: 0 !important;
    color: black !important;
  }

  /* Content area should use full width */
  body > #root > div,
  .flex-1 {
    max-width: 100% !important;
    width: 100% !important;
    overflow: visible !important;
    height: auto !important;
  }

  main {
    overflow: visible !important;
    height: auto !important;
  }

  /* Preserve shift/leave colors when printing */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Force light mode for print */
  html.dark .bg-white    { background-color: #ffffff !important; }
  html.dark .bg-gray-100 { background-color: #f3f4f6 !important; }
  html.dark .text-gray-900 { color: #111827 !important; }
  html.dark .text-gray-700 { color: #374151 !important; }
  html.dark th { background-color: #f1f5f9 !important; color: #111827 !important; }

  /* Compact table for print */
  table {
    font-size: 9px;
    border-collapse: collapse;
    width: 100%;
  }

  th, td {
    padding: 2px 3px !important;
  }

  /* Avoid page breaks inside table rows */
  tr {
    break-inside: avoid;
  }

  /* Avoid page breaks inside main containers */
  .print-no-break {
    break-inside: avoid;
    page-break-inside: avoid;
  }

  /* Report section: page break before each section */
  .print-section {
    break-inside: avoid;
    page-break-inside: avoid;
    margin-bottom: 8px;
  }

  /* Force page break before element */
  .print-page-break {
    break-before: page;
    page-break-before: always;
  }

  /* Portrait override for portrait pages */
  .print-portrait {
    page: portrait-page;
  }
  @page portrait-page {
    size: portrait;
    margin: 10mm;
  }
}

.schedule-grid {
  display: grid;
  overflow-x: auto;
}

.schedule-cell {
  @apply text-xs text-center font-semibold border border-gray-200 rounded;
  min-width: 32px;
  min-height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ── Mobile UX Improvements (Task-04 + Task-05) ─────────────── */

/* 1. Touch-smooth scrolling on all scrollable containers */
.overflow-auto,
.overflow-x-auto,
.overflow-y-auto {
  -webkit-overflow-scrolling: touch;
}

@media (max-width: 767px) {
  /* 2. Button minimum touch targets (Apple HIG: 44×44px) */
  button {
    min-height: 44px;
    min-width: 44px;
  }

  /* Exception: absolutely-positioned tiny overlay/icon buttons
     (e.g. delete × button in schedule cells, note icons) */
  button[class*="absolute"],
  button[class*="leading-none"],
  button[class*="w-3"],
  button[class*="h-3"] {
    min-height: unset;
    min-width: unset;
  }

  /* 3. Modal dialogs: full width, no side margins on mobile */
  /* Remove padding from the fixed overlay wrapper so modals can go edge-to-edge */
  .fixed.inset-0 {
    padding: 0 !important;
  }

  /* Modal inner containers: full width, no horizontal margin */
  .fixed.inset-0 > div {
    max-width: 100vw !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }

  /* 4. Table containers: ensure horizontal scroll is touch-enabled */
  .table-mobile-scroll {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  /* 5. Global table responsiveness: make ALL tables scroll horizontally
        on mobile rather than overflowing the viewport.
        We convert <table> to a scrollable block on narrow screens.
        Tables that already have an overflow-x-auto parent are unaffected
        because the parent already clips them. */
  table {
    display: block;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    max-width: 100%;
  }

  /* Keep thead/tbody/tr/td as normal block/table-* so layout is preserved */
  thead, tbody, tfoot {
    display: table;
    width: 100%;
  }

  /* 6. Page-level padding: reduce horizontal padding on mobile so content
        fits without requiring sideways scroll of the entire page */
  main > div,
  main > section {
    padding-left: 0.5rem !important;
    padding-right: 0.5rem !important;
  }

  /* 7. Flex-wrap filter bars so they wrap instead of overflow */
  .flex.gap-2.items-center:not(.no-wrap),
  .flex.gap-3.items-center:not(.no-wrap) {
    flex-wrap: wrap;
  }
}

/* ── Print Styles ────────────────────────────────────────────── */

@media print {
  /* Hide sidebar, mobile header, and other UI chrome */
  aside,
  header,
  .print\:hidden,
  [class*="print:hidden"] {
    display: none !important;
  }

  /* Full-width content area */
  body, html {
    background: white !important;
    color: black !important;
  }

  /* Remove background colors from layout containers */
  .bg-gray-100,
  .bg-gray-50,
  .bg-slate-800,
  .bg-slate-900 {
    background: white !important;
  }

  /* Main content takes full width */
  main {
    width: 100% !important;
    overflow: visible !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Page breaks */
  table { page-break-inside: avoid; }
  tr { page-break-inside: avoid; }

  /* Ensure links print as plain text */
  a[href]:after {
    content: none !important;
  }

  /* Remove shadows */
  * {
    box-shadow: none !important;
    text-shadow: none !important;
  }
}
